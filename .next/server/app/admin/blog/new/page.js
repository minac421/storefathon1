(()=>{var e={};e.id=5174,e.ids=[5174],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10501:(e,r,t)=>{Promise.resolve().then(t.bind(t,88896))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16581:(e,r,t)=>{Promise.resolve().then(t.bind(t,29502))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29502:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\minaa\\\\CascadeProjects\\\\conquerors-website\\\\src\\\\app\\\\admin\\\\blog\\\\new\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\admin\\blog\\new\\page.tsx","default")},33873:e=>{"use strict";e.exports=require("path")},58522:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=t(65239),a=t(48088),n=t(88170),o=t.n(n),l=t(30893),i={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(i[e]=()=>l[e]);t.d(r,i);let d={children:["",{children:["admin",{children:["blog",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,29502)),"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\admin\\blog\\new\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,54431)),"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,54413)),"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\admin\\blog\\new\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/admin/blog/new/page",pathname:"/admin/blog/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70263:(e,r,t)=>{"use strict";t.d(r,{P:()=>s,o:()=>a});var s=function(e){return e.GUIDE="guide",e.NEWS="news",e.TIPS="tips",e.ANALYSIS="analysis",e.MARKET="market",e.MEMES="memes",e.EXPERIENCE="experience",e}({}),a=function(e){return e.SWORD="sword",e.FIRE="fire",e.SHIELD="shield",e.CROWN="crown",e.CASTLE="castle",e.LAUGH="laugh",e}({})},88896:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(60687),a=t(43210),n=t(16189),o=t(85814),l=t.n(o),i=t(70263);let d=({value:e,onChange:r})=>{let t=(0,a.useRef)(null),n=e=>{let s=window.getSelection();if(!s||0===s.rangeCount)return;let a=s.getRangeAt(0),n=a.toString();if(!n)return;let o=document.createElement(e);o.textContent=n,a.deleteContents(),a.insertNode(o),t.current&&r(t.current.innerHTML)};return(0,s.jsxs)("div",{className:"border border-gray-300 rounded-md overflow-hidden",children:[(0,s.jsxs)("div",{className:"bg-gray-100 p-2 flex gap-2 border-b border-gray-300",children:[(0,s.jsx)("button",{type:"button",onClick:()=>n("h2"),className:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-gray-50",title:"عنوان رئيسي",children:"H2"}),(0,s.jsx)("button",{type:"button",onClick:()=>n("h3"),className:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-gray-50",title:"عنوان فرعي",children:"H3"}),(0,s.jsx)("button",{type:"button",onClick:()=>n("p"),className:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-gray-50",title:"فقرة",children:"P"}),(0,s.jsx)("button",{type:"button",onClick:()=>n("strong"),className:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-gray-50 font-bold",title:"غامق",children:"B"}),(0,s.jsx)("button",{type:"button",onClick:()=>n("em"),className:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-gray-50 italic",title:"مائل",children:"I"}),(0,s.jsx)("button",{type:"button",onClick:()=>n("u"),className:"px-2 py-1 bg-white border border-gray-300 rounded hover:bg-gray-50 underline",title:"تحته خط",children:"U"})]}),(0,s.jsx)("div",{ref:t,contentEditable:!0,dangerouslySetInnerHTML:{__html:e},onInput:e=>r(e.currentTarget.innerHTML),className:"p-4 min-h-[300px] focus:outline-none",dir:"rtl"})]})};function c(){let e=(0,n.useRouter)(),r=(0,n.useSearchParams)(),t="true"===r.get("edit"),o=r.get("id"),[c,u]=(0,a.useState)({title:"",summary:"",content:"",category:i.P.NEWS,featuredImage:"",author:"فريق الفاتحون",tags:"",isPublished:!1}),[m,p]=(0,a.useState)(t),[g,b]=(0,a.useState)(!1),[h,x]=(0,a.useState)(null),f=e=>{let{name:r,value:t,type:s}=e.target;if("checkbox"===s){let{checked:t}=e.target;u(e=>({...e,[r]:t}))}else u(e=>({...e,[r]:t}))},y=async r=>{r.preventDefault();try{b(!0),x(null);let r=c.tags.split(",").map(e=>e.trim()).filter(e=>""!==e),s={...c,tags:r};t&&o&&(s.id=o);let a=await fetch("/api/blog",{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw Error(`خطأ في الاتصال: ${a.status}`);let n=await a.json();if(n.success)e.push("/admin/blog");else throw Error(n.error||"حدث خطأ أثناء حفظ المقال")}catch(e){console.error("خطأ في إنشاء المقال:",e),x(e instanceof Error?e.message:"حدث خطأ أثناء حفظ المقال. يرجى المحاولة مرة أخرى.")}finally{b(!1)}};return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:t?"تعديل المقال":"مقال جديد"}),(0,s.jsxs)(l(),{href:"/admin/blog",className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-1 transform rotate-180",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L12.586 11H5a1 1 0 110-2h7.586l-2.293-2.293a1 1 0 010-1.414z",clipRule:"evenodd"})}),"العودة"]})]}),h&&(0,s.jsx)("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg mb-6",children:h}),(0,s.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:(0,s.jsxs)("form",{onSubmit:y,className:"p-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsxs)("label",{htmlFor:"title",className:"block text-gray-700 font-medium mb-2",children:["عنوان المقال ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"text",id:"title",name:"title",value:c.title,onChange:f,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"أدخل عنوان المقال"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsxs)("label",{htmlFor:"summary",className:"block text-gray-700 font-medium mb-2",children:["ملخص المقال ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("textarea",{id:"summary",name:"summary",value:c.summary,onChange:f,required:!0,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"اكتب ملخصًا قصيرًا للمقال (لا يزيد عن 300 حرف)",maxLength:300})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{htmlFor:"category",className:"block text-gray-700 font-medium mb-2",children:["الفئة ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("select",{id:"category",name:"category",value:c.category,onChange:f,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500",children:Object.entries(i.P).map(([e,r])=>(0,s.jsxs)("option",{value:r,children:[r===i.P.GUIDE&&"دليل اللاعبين",r===i.P.NEWS&&"أخبار اللعبة",r===i.P.TIPS&&"نصائح وحيل",r===i.P.ANALYSIS&&"تحليلات وتقييمات",r===i.P.MARKET&&"أخبار السوق"]},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"author",className:"block text-gray-700 font-medium mb-2",children:"الكاتب"}),(0,s.jsx)("input",{type:"text",id:"author",name:"author",value:c.author,onChange:f,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"اسم الكاتب"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsxs)("label",{htmlFor:"featuredImage",className:"block text-gray-700 font-medium mb-2",children:["رابط الصورة المصغرة ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"url",id:"featuredImage",name:"featuredImage",value:c.featuredImage,onChange:f,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"أدخل رابط الصورة (مثال: https://example.com/image.jpg)"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("label",{htmlFor:"tags",className:"block text-gray-700 font-medium mb-2",children:"الوسوم (مفصولة بفواصل)"}),(0,s.jsx)("input",{type:"text",id:"tags",name:"tags",value:c.tags,onChange:f,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-amber-500",placeholder:"مثال: قلاع, هيبة, أبطال"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"أدخل الوسوم مفصولة بفواصل"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("input",{type:"checkbox",id:"isPublished",name:"isPublished",checked:c.isPublished,onChange:f,className:"h-5 w-5 text-amber-600 focus:ring-amber-500 border-gray-300 rounded"}),(0,s.jsx)("label",{htmlFor:"isPublished",className:"mr-2 block text-gray-700",children:"نشر المقال"})]}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"إذا لم يتم تحديد هذا الخيار، سيتم حفظ المقال كمسودة ولن يظهر للزوار"})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsxs)("label",{htmlFor:"content",className:"block text-gray-700 font-medium mb-2",children:["محتوى المقال ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)(d,{value:c.content,onChange:e=>{u(r=>({...r,content:e}))}})]})]}),(0,s.jsxs)("div",{className:"mt-8 flex justify-end space-x-4 rtl:space-x-reverse",children:[(0,s.jsx)(l(),{href:"/admin/blog",className:"px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"إلغاء"}),(0,s.jsx)("button",{type:"submit",disabled:g,className:`px-6 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 ${g?"opacity-70 cursor-not-allowed":""}`,children:g?"جاري الحفظ...":t?"حفظ التغييرات":"حفظ المقال"})]})]})})]})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[7719,4738,7583],()=>t(58522));module.exports=s})();