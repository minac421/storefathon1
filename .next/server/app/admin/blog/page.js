(()=>{var e={};e.id=8563,e.ids=[8563],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8153:(e,t,s)=>{Promise.resolve().then(s.bind(s,70901))},10070:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=s(65239),a=s(48088),i=s(88170),n=s.n(i),l=s(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let d={children:["",{children:["admin",{children:["blog",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,48303)),"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\admin\\blog\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,94431)),"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(s.bind(s,54431)),"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,54413)),"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\admin\\blog\\page.tsx"],x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/admin/blog/page",pathname:"/admin/blog",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},48303:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\minaa\\\\CascadeProjects\\\\conquerors-website\\\\src\\\\app\\\\admin\\\\blog\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\minaa\\CascadeProjects\\conquerors-website\\src\\app\\admin\\blog\\page.tsx","default")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70263:(e,t,s)=>{"use strict";s.d(t,{P:()=>r,o:()=>a});var r=function(e){return e.GUIDE="guide",e.NEWS="news",e.TIPS="tips",e.ANALYSIS="analysis",e.MARKET="market",e.MEMES="memes",e.EXPERIENCE="experience",e}({}),a=function(e){return e.SWORD="sword",e.FIRE="fire",e.SHIELD="shield",e.CROWN="crown",e.CASTLE="castle",e.LAUGH="laugh",e}({})},70901:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(60687),a=s(43210),i=s(85814),n=s.n(i),l=s(16189),o=s(70263);let d={[o.P.GUIDE]:"دليل اللاعبين",[o.P.NEWS]:"أخبار اللعبة",[o.P.TIPS]:"نصائح وحيل",[o.P.ANALYSIS]:"تحليلات وتقييمات",[o.P.MARKET]:"أخبار السوق"};function c(){(0,l.useRouter)();let[e,t]=(0,a.useState)([]),[s,i]=(0,a.useState)({total:0,page:1,limit:10,totalPages:0}),[o,c]=(0,a.useState)(!0),[x,m]=(0,a.useState)(null),[p,u]=(0,a.useState)(!1),[h,g]=(0,a.useState)(null),[b,y]=(0,a.useState)(!1),[f,j]=(0,a.useState)(null),v=e=>{e>0&&e<=s.totalPages&&i(t=>({...t,page:e}))},w=e=>{let t=new Date(e);return new Intl.DateTimeFormat("ar-EG",{year:"numeric",month:"long",day:"numeric"}).format(t)},N=e=>{g(e),u(!0)},P=async()=>{if(h)try{let s=await fetch(`/api/blog?id=${h}`,{method:"DELETE"});if(!s.ok)throw Error(`خطأ في الاتصال: ${s.status}`);t(e.filter(e=>e.id!==h)),u(!1),g(null),j("تم حذف المقال بنجاح"),setTimeout(()=>j(null),3e3)}catch(e){console.error("خطأ في حذف المقال:",e),m("حدث خطأ أثناء حذف المقال. يرجى المحاولة مرة أخرى."),setTimeout(()=>m(null),3e3)}},C=async s=>{console.log("بدء الموافقة على المقال:",s),y(!0),g(s);try{let r={id:s,isPublished:!0,isApproved:!0};console.log("إرسال طلب PUT إلى /api/blog:",JSON.stringify(r,null,2));let a=await fetch("/api/blog",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),i=await a.json().catch(()=>({}));if(console.log("استجابة الخادم:",{status:a.status,data:i}),!a.ok)throw Error(i.error||`خطأ في الاتصال: ${a.status}`);t(e.map(e=>e._id===s?{...e,isPublished:!0,isApproved:!0}:e)),j("تمت الموافقة على المقال ونشره بنجاح"),setTimeout(()=>j(null),3e3)}catch(t){console.error("خطأ في الموافقة على المقال:",t);let e=t instanceof Error?t.message:"حدث خطأ غير معروف";m(`حدث خطأ أثناء الموافقة على المقال: ${e}`),setTimeout(()=>m(null),3e3)}finally{y(!1),g(null)}};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold",children:"إدارة المدونة"}),(0,r.jsxs)(n(),{href:"/admin/blog/new",className:"bg-amber-600 hover:bg-amber-700 text-white px-4 py-2 rounded-lg flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 ml-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})}),"مقال جديد"]})]}),x&&(0,r.jsx)("div",{className:"bg-red-100 text-red-700 p-4 rounded-lg mb-6",children:x}),f&&(0,r.jsx)("div",{className:"bg-green-100 text-green-700 p-4 rounded-lg mb-6",children:f}),o?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-amber-600 border-t-transparent rounded-full animate-spin mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600",children:"جاري تحميل المقالات..."})]}):0===e.length?(0,r.jsxs)("div",{className:"text-center bg-gray-50 p-8 rounded-lg",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-700 mb-2",children:"لا توجد مقالات"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"أضف مقالات جديدة لتظهر هنا"}),(0,r.jsx)(n(),{href:"/admin/blog/new",className:"bg-amber-600 hover:bg-amber-700 text-white px-6 py-2 rounded-lg inline-block",children:"إضافة مقال جديد"})]}):(0,r.jsx)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden mb-6",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"العنوان"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الفئة"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الكاتب"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"المشاهدات"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"تاريخ النشر"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الحالة"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"الإجراءات"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((e,t)=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.slug})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-amber-100 text-amber-800",children:d[e.category]||e.category})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.author?"string"==typeof e.author?e.author:e.author?.name||"مستخدم":"غير معروف"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.views}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:w(e.createdAt)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${e.isPublished?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.isPublished?"منشور":"مسودة"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-left text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex space-x-2 rtl:space-x-reverse",children:[(0,r.jsx)(n(),{href:`/blog/${e.slug}`,className:"text-blue-600 hover:text-blue-900",target:"_blank",children:"عرض"}),(0,r.jsx)(n(),{href:`/admin/blog/new?edit=true&id=${e._id}`,className:"text-amber-600 hover:text-amber-900",children:"تعديل"}),!e.isPublished&&(0,r.jsx)("button",{onClick:()=>C(e._id||""),className:"text-green-600 hover:text-green-900",disabled:b&&h===e._id,children:b&&h===e._id?"جاري...":"نشر"}),(0,r.jsx)("button",{onClick:()=>N(e._id||""),className:"text-red-600 hover:text-red-900",disabled:p&&h===e._id,children:p&&h===e._id?"جاري...":"حذف"})]})})]},`post-${e.id}-${t}`))})]})}),!o&&s.totalPages>1&&(0,r.jsx)("div",{className:"flex justify-center mt-4",children:(0,r.jsxs)("nav",{className:"inline-flex rounded-md shadow-sm -space-x-px rtl:space-x-reverse","aria-label":"Pagination",children:[(0,r.jsx)("button",{onClick:()=>v(s.page-1),disabled:1===s.page,className:`relative inline-flex items-center px-4 py-2 rounded-r-md border ${1===s.page?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-amber-50"} text-sm font-medium`,children:"السابق"}),Array.from({length:s.totalPages}).map((e,t)=>{let a=t+1;return(0,r.jsx)("button",{onClick:()=>v(a),className:`relative inline-flex items-center px-4 py-2 border ${s.page===a?"bg-amber-600 text-white font-bold":"bg-white text-gray-700 hover:bg-amber-50"} text-sm`,children:a},a)}),(0,r.jsx)("button",{onClick:()=>v(s.page+1),disabled:s.page===s.totalPages,className:`relative inline-flex items-center px-4 py-2 rounded-l-md border ${s.page===s.totalPages?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-white text-gray-700 hover:bg-amber-50"} text-sm font-medium`,children:"التالي"})]})}),p&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"تأكيد الحذف"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"هل أنت متأكد من رغبتك في حذف هذا المقال؟ لا يمكن التراجع عن هذه العملية."}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2 rtl:space-x-reverse",children:[(0,r.jsx)("button",{onClick:()=>{g(null),u(!1)},className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"إلغاء"}),(0,r.jsx)("button",{onClick:P,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"حذف"})]})]})})]})}},71705:(e,t,s)=>{Promise.resolve().then(s.bind(s,48303))}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[7719,4738,7583],()=>s(10070));module.exports=r})();