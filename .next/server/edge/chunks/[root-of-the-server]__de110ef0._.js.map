{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/middleware.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\n// Supported locales\nconst locales = ['ar', 'en', 'tr'];\nconst defaultLocale = 'ar';\n\n// Set matcher for routes that should trigger the middleware\nexport const config = {\n  // استبعاد المسار الجذر / حتى يتم عرض الصفحة الرئيسية مباشرة\n  matcher: ['/((?!api|_next/static|_next/image|favicon.ico|images|.*\\\\.png$|.*\\\\.jpg$|.*\\\\.svg$|$).*)'],\n};\n\nconst cookieName = 'NEXT_LOCALE';\n\n/**\n * Simple function to extract language preference from Accept-Language header\n */\nfunction getPreferredLocale(acceptLanguageHeader: string | null): string {\n  if (!acceptLanguageHeader) return defaultLocale;\n  \n  // Parse the Accept-Language header\n  const languages = acceptLanguageHeader.split(',');\n  const primaryLanguage = languages[0].split('-')[0].toLowerCase();\n  \n  // Check if primary language is in our supported locales\n  if (locales.includes(primaryLanguage)) {\n    return primaryLanguage;\n  }\n  \n  return defaultLocale;\n}\n\nexport function middleware(request: NextRequest) {\n  const pathname = request.nextUrl.pathname;\n  \n  // تجاهل المسار الجذر / حتى تظهر الصفحة الرئيسية\n  if (pathname === '/') {\n    return NextResponse.next();\n  }\n  \n  // Check if the pathname already has a locale\n  const pathnameHasLocale = locales.some(\n    (locale) => pathname.startsWith(`/${locale}/`) || pathname === `/${locale}`\n  );\n  \n  // If the pathname already has a locale, pass it through\n  if (pathnameHasLocale) {\n    return NextResponse.next();\n  }\n  \n  // Get user's preferred locale from cookie or Accept-Language header\n  const cookieLocale = request.cookies.get(cookieName)?.value;\n  const preferredLocale = cookieLocale || getPreferredLocale(request.headers.get('Accept-Language'));\n  \n  // Build the new URL with locale prefix\n  const newUrl = new URL(\n    `/${preferredLocale}${pathname.startsWith('/') ? pathname : `/${pathname}`}`,\n    request.url\n  );\n  \n  // Preserve the search params\n  newUrl.search = request.nextUrl.search;\n  \n  // Set a cookie with the locale for future reference\n  const response = NextResponse.redirect(newUrl);\n  response.cookies.set(cookieName, preferredLocale, {\n    maxAge: 60 * 60 * 24 * 30, // 30 days\n    path: '/',\n  });\n  \n  return response;\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEA,oBAAoB;AACpB,MAAM,UAAU;IAAC;IAAM;IAAM;CAAK;AAClC,MAAM,gBAAgB;AAGf,MAAM,SAAS;IACpB,4DAA4D;IAC5D,SAAS;QAAC;KAA2F;AACvG;AAEA,MAAM,aAAa;AAEnB;;CAEC,GACD,SAAS,mBAAmB,oBAAmC;IAC7D,IAAI,CAAC,sBAAsB,OAAO;IAElC,mCAAmC;IACnC,MAAM,YAAY,qBAAqB,KAAK,CAAC;IAC7C,MAAM,kBAAkB,SAAS,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,WAAW;IAE9D,wDAAwD;IACxD,IAAI,QAAQ,QAAQ,CAAC,kBAAkB;QACrC,OAAO;IACT;IAEA,OAAO;AACT;AAEO,SAAS,WAAW,OAAoB;IAC7C,MAAM,WAAW,QAAQ,OAAO,CAAC,QAAQ;IAEzC,gDAAgD;IAChD,IAAI,aAAa,KAAK;QACpB,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;IAEA,6CAA6C;IAC7C,MAAM,oBAAoB,QAAQ,IAAI,CACpC,CAAC,SAAW,SAAS,UAAU,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC,KAAK,aAAa,CAAC,CAAC,EAAE,QAAQ;IAG7E,wDAAwD;IACxD,IAAI,mBAAmB;QACrB,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B;IAEA,oEAAoE;IACpE,MAAM,eAAe,QAAQ,OAAO,CAAC,GAAG,CAAC,aAAa;IACtD,MAAM,kBAAkB,gBAAgB,mBAAmB,QAAQ,OAAO,CAAC,GAAG,CAAC;IAE/E,uCAAuC;IACvC,MAAM,SAAS,IAAI,IACjB,CAAC,CAAC,EAAE,kBAAkB,SAAS,UAAU,CAAC,OAAO,WAAW,CAAC,CAAC,EAAE,UAAU,EAAE,EAC5E,QAAQ,GAAG;IAGb,6BAA6B;IAC7B,OAAO,MAAM,GAAG,QAAQ,OAAO,CAAC,MAAM;IAEtC,oDAAoD;IACpD,MAAM,WAAW,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;IACvC,SAAS,OAAO,CAAC,GAAG,CAAC,YAAY,iBAAiB;QAChD,QAAQ,KAAK,KAAK,KAAK;QACvB,MAAM;IACR;IAEA,OAAO;AACT"}}]
}