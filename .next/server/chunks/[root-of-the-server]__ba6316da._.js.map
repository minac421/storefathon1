{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/minaa/CascadeProjects/conquerors-website/src/utils/mockData.ts"],"sourcesContent":["// نموذج بيانات رسائل الدردشة\r\nexport interface ChatMessage {\r\n  id: string;\r\n  sender: string;\r\n  senderAvatarId: number;\r\n  message: string;\r\n  timestamp: string;\r\n  interaction?: {\r\n    likes: string[];\r\n    isLiked?: boolean;\r\n  };\r\n}\r\n\r\n// إنشاء بيانات وهمية للرسائل الأولية\r\nexport function createMockMessages(): ChatMessage[] {\r\n  return [\r\n    { \r\n      id: '1', \r\n      sender: 'فاطمة', \r\n      senderAvatarId: 3, \r\n      message: 'مرحباً بالجميع في دردشة الفاتحون! هل يمكنني الحصول على نصائح لتطوير قلعتي؟', \r\n      timestamp: '2025-05-16T01:00:00.000Z',\r\n      interaction: {\r\n        likes: [],\r\n        isLiked: false\r\n      }\r\n    },\r\n    { \r\n      id: '2', \r\n      sender: 'عمر', \r\n      senderAvatarId: 1, \r\n      message: 'أهلاً فاطمة! أنصحك بالتركيز على تطوير الدفاعات أولاً وزيادة إنتاج الموارد', \r\n      timestamp: '2025-05-16T01:01:30.000Z',\r\n      interaction: {\r\n        likes: [],\r\n        isLiked: false\r\n      }\r\n    },\r\n    { \r\n      id: '3', \r\n      sender: 'خالد', \r\n      senderAvatarId: 5, \r\n      message: 'البوتات الذكية للمزارع ستساعدك كثيراً في توفير الموارد والوقت', \r\n      timestamp: '2025-05-16T01:03:00.000Z',\r\n      interaction: {\r\n        likes: [],\r\n        isLiked: false\r\n      }\r\n    },\r\n  ];\r\n}\r\n\r\n// نموذج بيانات المستخدمين المتصلين\r\nexport interface OnlineUser {\r\n  name: string;\r\n  avatarId: number;\r\n}\r\n\r\n// إنشاء بيانات وهمية للمستخدمين المتصلين\r\nexport function createMockOnlineUsers(): OnlineUser[] {\r\n  return [\r\n    { name: 'عمر', avatarId: 1 },\r\n    { name: 'خالد', avatarId: 5 },\r\n    { name: 'فاطمة', avatarId: 3 },\r\n    { name: 'محمد', avatarId: 2 },\r\n    { name: 'سارة', avatarId: 6 },\r\n    { name: 'أحمد', avatarId: 8 },\r\n    { name: 'نورا', avatarId: 4 }\r\n  ];\r\n} "],"names":[],"mappings":"AAAA,6BAA6B;;;;;AActB,SAAS;IACd,OAAO;QACL;YACE,IAAI;YACJ,QAAQ;YACR,gBAAgB;YAChB,SAAS;YACT,WAAW;YACX,aAAa;gBACX,OAAO,EAAE;gBACT,SAAS;YACX;QACF;QACA;YACE,IAAI;YACJ,QAAQ;YACR,gBAAgB;YAChB,SAAS;YACT,WAAW;YACX,aAAa;gBACX,OAAO,EAAE;gBACT,SAAS;YACX;QACF;QACA;YACE,IAAI;YACJ,QAAQ;YACR,gBAAgB;YAChB,SAAS;YACT,WAAW;YACX,aAAa;gBACX,OAAO,EAAE;gBACT,SAAS;YACX;QACF;KACD;AACH;AASO,SAAS;IACd,OAAO;QACL;YAAE,MAAM;YAAO,UAAU;QAAE;QAC3B;YAAE,MAAM;YAAQ,UAAU;QAAE;QAC5B;YAAE,MAAM;YAAS,UAAU;QAAE;QAC7B;YAAE,MAAM;YAAQ,UAAU;QAAE;QAC5B;YAAE,MAAM;YAAQ,UAAU;QAAE;QAC5B;YAAE,MAAM;YAAQ,UAAU;QAAE;QAC5B;YAAE,MAAM;YAAQ,UAAU;QAAE;KAC7B;AACH","debugId":null}},
    {"offset": {"line": 140, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/minaa/CascadeProjects/conquerors-website/src/utils/chatStore.js"],"sourcesContent":["import { createMockOnlineUsers } from '@/utils/mockData';\r\n\r\n// مخزن مشترك للدردشة - يستخدم على جانب الخادم والعميل\r\nexport const chatStore = {\r\n  // مصفوفة الرسائل\r\n  messages: [],\r\n  \r\n  // معرف آخر رسالة\r\n  lastMessageId: 1,\r\n  \r\n  // الحد الأقصى لعدد الرسائل المخزنة\r\n  maxMessages: 100,\r\n  \r\n  // إضافة رسالة جديدة\r\n  addMessage(message) {\r\n    // إنشاء معرف جديد للرسالة\r\n    const messageId = `server-${this.lastMessageId++}`;\r\n    \r\n    // إنشاء نسخة من الرسالة مع المعرف الجديد\r\n    const savedMessage = {\r\n      id: messageId,\r\n      ...message,\r\n      // ضمان وجود وقت وتفاعل\r\n      timestamp: message.timestamp || new Date().toISOString(),\r\n      interaction: message.interaction || {\r\n        likes: [],\r\n        isLiked: false\r\n      }\r\n    };\r\n    \r\n    // إضافة الرسالة إلى المصفوفة\r\n    this.messages.push(savedMessage);\r\n    \r\n    // التحقق من عدم تجاوز الحد الأقصى\r\n    if (this.messages.length > this.maxMessages) {\r\n      // إزالة أقدم رسالة\r\n      this.messages.shift();\r\n    }\r\n    \r\n    return savedMessage;\r\n  },\r\n  \r\n  // الحصول على الرسائل مع اختيار الحد الأقصى\r\n  getMessages(limit = 20) {\r\n    // ضمان أن الحد الأقصى عدد صحيح\r\n    const count = Math.min(parseInt(limit) || 20, this.messages.length);\r\n    \r\n    // إذا لم تكن هناك رسائل، عودة مصفوفة فارغة\r\n    if (this.messages.length === 0) {\r\n      return this.createInitialMessages();\r\n    }\r\n    \r\n    // إعادة آخر count رسائل\r\n    return this.messages.slice(-count);\r\n  },\r\n  \r\n  // تحديث تفاعل الرسالة\r\n  updateMessageInteraction(messageId, userId, isLiked) {\r\n    // البحث عن الرسالة\r\n    const message = this.messages.find(msg => msg.id === messageId);\r\n    \r\n    if (!message) {\r\n      return null;\r\n    }\r\n    \r\n    // تحديث التفاعل\r\n    if (isLiked) {\r\n      // إضافة المستخدم إلى قائمة الإعجابات إذا لم يكن موجوداً\r\n      if (!message.interaction.likes.includes(userId)) {\r\n        message.interaction.likes.push(userId);\r\n      }\r\n    } else {\r\n      // إزالة المستخدم من قائمة الإعجابات\r\n      message.interaction.likes = message.interaction.likes.filter(id => id !== userId);\r\n    }\r\n    \r\n    return message;\r\n  },\r\n  \r\n  // إنشاء رسائل أولية إذا لم تكن هناك رسائل\r\n  createInitialMessages() {\r\n    // استخدام بيانات المستخدمين الوهمية لإنشاء رسائل أولية\r\n    const mockUsers = createMockOnlineUsers();\r\n    \r\n    const initialMessages = [\r\n      {\r\n        message: 'مرحباً بالجميع في دردشة الفاتحون! هل يمكنني الحصول على نصائح لتطوير قلعتي؟',\r\n        sender: mockUsers[0].name,\r\n        senderAvatarId: mockUsers[0].avatarId,\r\n        timestamp: new Date(Date.now() - 3600000).toISOString() // قبل ساعة\r\n      },\r\n      {\r\n        message: 'أهلاً! أنصحك بالتركيز على تطوير الدفاعات أولاً وزيادة إنتاج الموارد',\r\n        sender: mockUsers[1].name,\r\n        senderAvatarId: mockUsers[1].avatarId,\r\n        timestamp: new Date(Date.now() - 3300000).toISOString() // قبل 55 دقيقة\r\n      },\r\n      {\r\n        message: 'البوتات الذكية للمزارع ستساعدك كثيراً في توفير الموارد والوقت',\r\n        sender: mockUsers[2].name,\r\n        senderAvatarId: mockUsers[2].avatarId,\r\n        timestamp: new Date(Date.now() - 3000000).toISOString() // قبل 50 دقيقة\r\n      },\r\n      {\r\n        message: 'كما يجب عليك الانضمام لتحالف قوي للحصول على المساعدة والحماية',\r\n        sender: mockUsers[3].name,\r\n        senderAvatarId: mockUsers[3].avatarId,\r\n        timestamp: new Date(Date.now() - 2700000).toISOString() // قبل 45 دقيقة\r\n      },\r\n      {\r\n        message: 'هل جربت استراتيجية الهجوم المتعدد المراحل؟ فعالة جداً!',\r\n        sender: mockUsers[0].name,\r\n        senderAvatarId: mockUsers[0].avatarId,\r\n        timestamp: new Date(Date.now() - 1800000).toISOString() // قبل 30 دقيقة\r\n      }\r\n    ];\r\n    \r\n    // حفظ الرسائل المبدئية\r\n    initialMessages.forEach(msg => this.addMessage(msg));\r\n    \r\n    return this.messages;\r\n  }\r\n};\r\n\r\n// إنشاء رسائل أولية عند بدء التشغيل\r\nif (chatStore.messages.length === 0) {\r\n  chatStore.createInitialMessages();\r\n}\r\n\r\nexport default chatStore; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 259, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/minaa/CascadeProjects/conquerors-website/src/app/api/socket/fallback/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { chatStore } from '@/utils/chatStore';\r\n\r\n// توفير واجهة برمجة تطبيقات احتياطية للدردشة عندما يفشل Socket.IO\r\n// هذا يمكن أن يساعد في تقليل أخطاء xhr poll error\r\n\r\nexport async function GET(request) {\r\n  try {\r\n    // قراءة آخر الرسائل\r\n    const messages = chatStore.getMessages(20);\r\n    \r\n    return NextResponse.json({\r\n      success: true,\r\n      messages,\r\n      mode: 'fallback',\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  } catch (error) {\r\n    console.error('Error fetching fallback messages:', error);\r\n    return NextResponse.json({ \r\n      success: false, \r\n      error: 'فشل في جلب بيانات الدردشة الاحتياطية',\r\n      mode: 'error'\r\n    }, { status: 500 });\r\n  }\r\n}\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    const body = await request.json();\r\n    \r\n    if (!body.message || !body.sender) {\r\n      return NextResponse.json({ \r\n        success: false, \r\n        error: 'بيانات غير مكتملة',\r\n        mode: 'error'\r\n      }, { status: 400 });\r\n    }\r\n    \r\n    // إضافة رسالة جديدة عبر المخزن المشترك\r\n    const newMessage = {\r\n      message: body.message,\r\n      sender: body.sender,\r\n      senderAvatarId: body.senderAvatarId || 1,\r\n      timestamp: new Date().toISOString(),\r\n      interaction: {\r\n        likes: [],\r\n        isLiked: false\r\n      }\r\n    };\r\n    \r\n    const savedMessage = chatStore.addMessage(newMessage);\r\n    \r\n    return NextResponse.json({\r\n      success: true,\r\n      message: savedMessage,\r\n      mode: 'fallback'\r\n    });\r\n  } catch (error) {\r\n    console.error('Error adding fallback message:', error);\r\n    return NextResponse.json({ \r\n      success: false, \r\n      error: 'فشل في إضافة الرسالة',\r\n      mode: 'error'\r\n    }, { status: 500 });\r\n  }\r\n} "],"names":[],"mappings":";;;;AAAA;AACA;;;AAKO,eAAe,IAAI,OAAO;IAC/B,IAAI;QACF,oBAAoB;QACpB,MAAM,WAAW,2HAAA,CAAA,YAAS,CAAC,WAAW,CAAC;QAEvC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT;YACA,MAAM;YACN,WAAW,IAAI,OAAO,WAAW;QACnC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;YACP,MAAM;QACR,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAE/B,IAAI,CAAC,KAAK,OAAO,IAAI,CAAC,KAAK,MAAM,EAAE;YACjC,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,OAAO;gBACP,MAAM;YACR,GAAG;gBAAE,QAAQ;YAAI;QACnB;QAEA,uCAAuC;QACvC,MAAM,aAAa;YACjB,SAAS,KAAK,OAAO;YACrB,QAAQ,KAAK,MAAM;YACnB,gBAAgB,KAAK,cAAc,IAAI;YACvC,WAAW,IAAI,OAAO,WAAW;YACjC,aAAa;gBACX,OAAO,EAAE;gBACT,SAAS;YACX;QACF;QAEA,MAAM,eAAe,2HAAA,CAAA,YAAS,CAAC,UAAU,CAAC;QAE1C,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,SAAS;YACT,MAAM;QACR;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,OAAO;YACP,MAAM;QACR,GAAG;YAAE,QAAQ;QAAI;IACnB;AACF","debugId":null}}]
}